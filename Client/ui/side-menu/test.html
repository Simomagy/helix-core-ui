<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu - Test</title>
    <link rel="stylesheet" href="style.css">
    <style>
		body {
			background-color: #0a0a0a;
		}
        .test-controls {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 10000;
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #fff;
            max-width: 300px;
        }

        .test-controls h3 {
            margin: 0 0 15px 0;
            color: #fff;
            font-size: 18px;
        }

        .test-controls button {
            display: block;
            width: 100%;
            margin-bottom: 10px;
            padding: 10px 15px;
            background: #fff;
            color: #0a0a0a;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: background 0.2s;
        }

        .test-controls button:hover {
            background: #9b9b9b;
        }

        .test-controls button.danger {
            background: #ef4444;
            color: white;
        }

        .test-controls button.danger:hover {
            background: #dc2626;
        }

        #event-log {
            margin-top: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            max-height: 200px;
            overflow-y: auto;
            font-size: 12px;
            font-family: monospace;
        }

        #event-log .log-entry {
            margin-bottom: 5px;
            color: #fff;
        }

        #event-log .log-entry .event-name {
            font-weight: bold;
            color: #fbbf24;
        }
    </style>
</head>
<body>
    <!-- Test Controls -->
    <div class="test-controls">
        <h3>Context Menu Test</h3>
        <button onclick="testBasicMenu()">Basic Menu</button>
        <button onclick="testFullMenu()">Full Menu (All Types)</button>
        <button onclick="testDropdownMenu()">Dropdown Menu</button>
        <button onclick="testFormMenu()">Form Menu</button>
        <button onclick="closeMenu()" class="danger">Close Menu</button>

        <div id="event-log"></div>
    </div>

    <!-- Menu UI -->
    <div class="screen hidden">
        <div class="side-menu hidden" tabindex="0" id="MenuFocusCatcher">
            <div class="header">
                <div class="logo">
                    <img src="./media/icons/Context-menu-icon.svg" alt="">
                </div>
                <h1 class="title">Menu</h1>
            </div>

            <div class="content">
                <div id="menu-container" class="options">
                    <!-- Menu items will be dynamically generated by JavaScript -->
                </div>
            </div>

            <div class="info">
                <div class="head">
                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9.00033 13.167C9.23644 13.167 9.43449 13.087 9.59449 12.927C9.75449 12.767 9.83422 12.5692 9.83366 12.3337V9.00033C9.83366 8.76422 9.75366 8.56616 9.59366 8.40616C9.43366 8.24616 9.23588 8.16644 9.00033 8.16699C8.76422 8.16699 8.56616 8.24699 8.40616 8.40699C8.24616 8.56699 8.16644 8.76477 8.16699 9.00033V12.3337C8.16699 12.5698 8.24699 12.7678 8.40699 12.9278C8.56699 13.0878 8.76477 13.1675 9.00033 13.167ZM9.00033 6.50033C9.23644 6.50033 9.43449 6.42033 9.59449 6.26033C9.75449 6.10033 9.83422 5.90255 9.83366 5.66699C9.83366 5.43088 9.75366 5.23283 9.59366 5.07283C9.43366 4.91283 9.23588 4.8331 9.00033 4.83366C8.76422 4.83366 8.56616 4.91366 8.40616 5.07366C8.24616 5.23366 8.16644 5.43144 8.16699 5.66699C8.16699 5.9031 8.24699 6.10116 8.40699 6.26116C8.56699 6.42116 8.76477 6.50088 9.00033 6.50033ZM9.00033 17.3337C7.84755 17.3337 6.76422 17.1148 5.75033 16.677C4.73644 16.2392 3.85449 15.6456 3.10449 14.8962C2.35449 14.1462 1.76088 13.2642 1.32366 12.2503C0.886437 11.2364 0.667548 10.1531 0.666992 9.00033C0.666992 7.84755 0.885881 6.76422 1.32366 5.75033C1.76144 4.73644 2.35505 3.85449 3.10449 3.10449C3.85449 2.35449 4.73644 1.76088 5.75033 1.32366C6.76422 0.886437 7.84755 0.667548 9.00033 0.666992C10.1531 0.666992 11.2364 0.885881 12.2503 1.32366C13.2642 1.76144 14.1462 2.35505 14.8962 3.10449C15.6462 3.85449 16.24 4.73644 16.6778 5.75033C17.1156 6.76422 17.3342 7.84755 17.3337 9.00033C17.3337 10.1531 17.1148 11.2364 16.677 12.2503C16.2392 13.2642 15.6456 14.1462 14.8962 14.8962C14.1462 15.6462 13.2642 16.24 12.2503 16.6778C11.2364 17.1156 10.1531 17.3342 9.00033 17.3337Z" fill="#FFFFFF"/>
                    </svg>
                    <p>Information</p>
                </div>
                <p class="description">Select an option to see more information</p>
            </div>
        </div>
    </div>

    <div id="notifications-container"></div>

    <script>
        // Mock hEvent - Logs all Lua callbacks
        const eventLog = [];
        window.hEvent = function(eventName, data) {
            const logEntry = {
                time: new Date().toLocaleTimeString(),
                event: eventName,
                data: data
            };
            eventLog.push(logEntry);

            console.log(`[Lua Event] ${eventName}:`, data);

            // Update UI log
            const logDiv = document.getElementById('event-log');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `<span class="event-name">${eventName}</span>: ${JSON.stringify(data)}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;

            // Keep only last 10 entries
            while (logDiv.children.length > 10) {
                logDiv.removeChild(logDiv.firstChild);
            }
        };

        // Helper to send NUI message
        function sendNUIMessage(action, args = null) {
            window.postMessage({
                name: action,
                args: args ? [args] : []
            });
        }

        // Test: Basic Menu
        function testBasicMenu() {
            // 1. Clear existing
            sendNUIMessage('ClearMenuItems');

            // 2. Add items individually
            const items = [
                {
                    id: 'action1',
                    type: 'button',
                    text: 'Primary Action',
                    label: 'Execute Command',
                    primary: true
                },
                {
                    id: 'action2',
                    type: 'button',
                    text: 'Secondary Action',
                    label: 'Open Settings'
                },
                {
                    id: 'checkbox1',
                    type: 'checkbox',
                    label: 'Enable Feature',
                    checked: false
                },
                {
                    id: 'checkbox2',
                    type: 'checkbox',
                    label: 'Auto Save',
                    checked: true
                },
                {
                    id: 'color1',
                    type: 'color',
                    label: 'Pick Color',
                    value: '#00FBDD'
                },
                {
                    id: 'list1',
                    type: 'list-picker',
                    label: 'Difficulty',
                    list: [
                        { label: 'Easy', value: 1 },
                        { label: 'Medium', value: 2 },
                        { label: 'Hard', value: 3 },
                        { label: 'Expert', value: 4 }
                    ]
                },
                {
                    id: 'radio1',
                    type: 'radio',
                    label: 'Game Mode',
                    options: [
                        { value: 'single', text: 'Single Player', checked: true },
                        { value: 'multi', text: 'Multiplayer' },
                        { value: 'coop', text: 'Co-op' }
                    ]
                }
            ];

            items.forEach(item => sendNUIMessage('AddMenuItem', item));

            // 3. Build/Show
            sendNUIMessage('BuildMenu');

            // 4. Set Info
            sendNUIMessage('SetMenuInfo', {
                title: 'Basic Menu',
                description: 'Simple menu with buttons and checkboxes'
            });
        }

        // Test: Full Menu (All Input Types)
        function testFullMenu() {
            sendNUIMessage('ClearMenuItems');

            const items = [
                {
                    id: 'btn1',
                    type: 'button',
                    text: 'Action Button',
                    label: 'Click Me'
                },
                {
                    id: 'category1',
                    type: 'text-display',
                    data: 'Category 1'
                },
                {
                    id: 'chk1',
                    type: 'checkbox',
                    label: 'Enable Option',
                    checked: false
                },
                {
                    id: 'range1',
                    type: 'range',
                    label: 'Volume',
                    min: 0,
                    max: 100,
                    value: 50
                },
                {
                    id: 'txt1',
                    type: 'text-input',
                    label: 'Username',
                    placeholder: 'Enter username'
                },
                {
                    id: 'num1',
                    type: 'number',
                    label: 'Amount',
                    value: 100
                },
                {
                    id: 'select1',
                    type: 'select',
                    label: 'Choose Vehicle',
                    options: [
                        { value: 'car1', text: 'Sports Car', selected: true },
                        { value: 'car2', text: 'SUV' },
                        { value: 'car3', text: 'Motorcycle' },
                        { value: 'car4', text: 'Truck' }
                    ]
                },
                {
                    id: 'color1',
                    type: 'color',
                    label: 'Pick Color',
                    value: '#00FBDD'
                },
                {
                    id: 'list1',
                    type: 'list-picker',
                    label: 'Difficulty',
                    list: [
                        { label: 'Easy', value: 1 },
                        { label: 'Medium', value: 2 },
                        { label: 'Hard', value: 3 },
                        { label: 'Expert', value: 4 }
                    ]
                },
                {
                    id: 'date1',
                    type: 'date',
                    label: 'Select Date',
                    value: '2024-12-31'
                },
                {
                    id: 'radio1',
                    type: 'radio',
                    label: 'Game Mode',
                    options: [
                        { value: 'single', text: 'Single Player', checked: true },
                        { value: 'multi', text: 'Multiplayer' },
                        { value: 'coop', text: 'Co-op' }
                    ]
                }
            ];

            items.forEach(item => sendNUIMessage('AddMenuItem', item));
            sendNUIMessage('BuildMenu');

            sendNUIMessage('SetMenuInfo', {
                title: 'Complete Menu',
                description: 'Showcase of all available input types'
            });
        }

        // Test: Dropdown Menu
        function testDropdownMenu() {
            sendNUIMessage('ClearMenuItems');

            const items = [
                {
                    id: 'quick1',
                    type: 'button',
                    text: 'Quick Action 1'
                },
                {
                    id: 'quick2',
                    type: 'button',
                    text: 'Quick Action 2'
                },
                {
                    id: 'dropdown1',
                    type: 'dropdown',
                    label: 'Advanced Settings',
                    options: [
                        { id: 'adv1', type: 'checkbox', label: 'Debug Mode', checked: false },
                        { id: 'adv2', type: 'checkbox', label: 'Verbose Logging', checked: true },
                        { id: 'adv3', type: 'range', label: 'Cache Size', min: 0, max: 1000, value: 500 }
                    ]
                },
                {
                    id: 'dropdown2',
                    type: 'dropdown',
                    label: 'Graphics Options',
                    options: [
                        { id: 'gfx1', type: 'checkbox', label: 'Anti-Aliasing', checked: true },
                        { id: 'gfx2', type: 'checkbox', label: 'V-Sync', checked: false },
                        { id: 'gfx3', type: 'range', label: 'Quality', min: 0, max: 10, value: 7 }
                    ]
                },
                {
                    id: 'save',
                    type: 'button',
                    text: 'Save Settings'
                }
            ];

            items.forEach(item => sendNUIMessage('AddMenuItem', item));
            sendNUIMessage('BuildMenu');

            sendNUIMessage('SetMenuInfo', {
                title: 'Settings Menu',
                description: 'Menu with collapsible dropdown sections'
            });
        }

        // Test: Form Menu
        function testFormMenu() {
            sendNUIMessage('ClearMenuItems');

            const items = [
                {
                    id: 'display1',
                    type: 'text-display',
                    data: 'Please fill in your information:'
                },
                {
                    id: 'firstname',
                    type: 'text-input',
                    label: 'First Name',
                    placeholder: 'John'
                },
                {
                    id: 'lastname',
                    type: 'text-input',
                    label: 'Last Name',
                    placeholder: 'Doe'
                },
                {
                    id: 'email',
                    type: 'text-input',
                    label: 'Email',
                    placeholder: 'john@example.com'
                },
                {
                    id: 'password',
                    type: 'password',
                    label: 'Password',
                    placeholder: '••••••••'
                },
                {
                    id: 'age',
                    type: 'number',
                    label: 'Age',
                    value: 25
                },
                {
                    id: 'country',
                    type: 'select',
                    label: 'Country',
                    options: [
                        { value: 'us', text: 'United States', selected: true },
                        { value: 'uk', text: 'United Kingdom' },
                        { value: 'ca', text: 'Canada' },
                        { value: 'au', text: 'Australia' }
                    ]
                },
                {
                    id: 'terms',
                    type: 'checkbox',
                    label: 'I accept the terms and conditions',
                    checked: false
                },
                {
                    id: 'newsletter',
                    type: 'checkbox',
                    label: 'Subscribe to newsletter',
                    checked: true
                },
                {
                    id: 'submit',
                    type: 'button',
                    text: 'Submit Form'
                }
            ];

            items.forEach(item => sendNUIMessage('AddMenuItem', item));
            sendNUIMessage('BuildMenu');

            sendNUIMessage('SetMenuInfo', {
                title: 'Registration Form',
                description: 'Complete the form to create your account'
            });
        }

        // Close menu
        function closeMenu() {
            sendNUIMessage('CloseMenu');
        }

        // Show basic menu on load for demo
        setTimeout(() => {
            testFullMenu();
        }, 500);
    </script>

    <!-- Menu Script -->
    <script src="script.js"></script>
</body>
</html>

